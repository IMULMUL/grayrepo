<?php
// Decrypt chunk of text to get "omg_"
$key = "_V`J[N)UJKb[NW]Q";
$enc = hex2bin("1337023329274721226B0B286E367D60666E566A193C402123380A760F3A3823363501247B2F4D232F25162E3C327D3C2A2509293A2209332B25163A3D2E7D37363A0D6A3F275B30293F073F6E352471153F0D6A132B472625254E7B2B2F38322A22093C3E635927252F17382B337D332676272F343C4E306A0717382F2471713E38046A392F5A302E6B172B21397D323038032F2B3A5C34266B063E3D3E3A3F2C7602337B0C5B3C2B25421D3C382835717634223E6E4F3C262642292B21323D2933136A3A3C4620242F426A7B7A24343E244D25372A09062B39033369247D7915330E2432284C276A080D352032313D267F403B2E2B5A216A3F0D7B3C323C32377614223E6E4A30243F07296E383B713E38402F35215B38253E117B212335342D210F38372A452C6A2603212B77293E7F240539383B4C75222E107B27393B303122402829215D3D2F39420F2135247D7F2108257B1D48272B23422C272435343B76013D3A370921256B283A3C322939737614223E6E6E3A28270B356E1C343F3876480E3A3840316A090D2C2732747F7F01093E336E5D3D2F6B07232D322D2536390E6A3428091625250C3E223B24713E38046A19215E3C2F674236212429713030403E332B093323270F7C3D772E383838092C322D483B3E6B01332F253C322B3312397B2F5B306A3B0E3A373239713D2F403A2E3E59303E38422B3C3839243C33046A3937091F232642132B392E3E3171136A183C4C343E3E103E6E04353E2F78");
$out = "";
for ($i=0; $i<strlen($enc); $i++){
	$cur = ord($enc[$i]);
	$tmp = $cur ^ ord($key[($i % strlen($key))]);
	$out .= chr($tmp);
}
echo $out."\n";

// Decrypting text to find out what to put in clipboard
$hh = "Qhyl{o3'pu'opz'v~s'mvyt3'~h{jolz";
$hout = "";
for ($i=0; $i<strlen($hh); $i++){
	$cur = ord($hh[$i]) - 0x7;
	$hout .= chr($cur);
}
echo $hout."\n";
$clipboardtxt = "";
for ($i=0; $i<strlen($hout); $i++){
	$clipboardtxt .= dechex(ord($hout[$i]));
}
echo "Clipboard copy this: ".$clipboardtxt."\n";

// Testing sha1 hash of clipboard data
// Cant get correct one...
/*
$hash = sha1($clipboardtxt);
echo "Clipboard Text SHA1 Hash: $hash \n";
//$enc4 = hex2bin(substr($hash,0,8));
$enc4 = "eryb";
$key4 = hex2bin("4A930B03");
$plain4 = "";
for ($i=0; $i<strlen($enc4); $i++){
	$tmp = ord($enc4[$i]) ^ ord($key4[$i]);
	$plain4 .= chr($tmp);
}
echo bin2hex($plain4)."\n";
*/

/*
00B7F758  50 41 4E 7B 56 4D 57 61 72 65 20 4C 61 62 79 72  PAN{VMWare Labyr  
00B7F768  65 6E 74 68 20 32 30 31 37 20 43 68 61 6C 6C 65  enth 2017 Challe  
00B7F778  6E 67 65 2E 20 56 4D 57 61 72 65 20 42 61 63 6B  nge. VMWare Back  
00B7F788  64 6F 6F 72 20 41 50 49 20 69 73 20 6E 69 63 65  door API is nice  
00B7F798  2E 7D 00 00 BF 82 AB DA FC FA B7 00 D6 9A CC 00  .}..¿.«Úüú·.Ö.Ì.  
PAN{VMWare Labyrenth 2017 Challenge. VMWare Backdoor API is nice.}
*/
?>