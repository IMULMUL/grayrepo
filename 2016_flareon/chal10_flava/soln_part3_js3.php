<?php
echo kek('9%E44%BC%1Ap', 90, 9, 97)."\n";
echo kek('%D0%94%18F%A5%C0', 162, 5, 199)."\n";
echo kek('%B7%5By4%B6%B4w', 199, 33, 147)."\n";
echo kek('%B7j%16%9E%04%88%E4%3Ej', 199, 17, 225)."\n";
echo kek('%DB%FCy%7D%E1', 168, 129, 247)."\n";
echo kek('%C4J%13sI%F7%3D', 173, 5, 195)."\n";
echo kek('%D6%E4zP%20%EC', 181, 9, 47)."\n";
echo kek('F%92%1C%D5%DF%02', 52, 65, 191)."\n";
echo kek('%3Eq%01%F4%C7G%FB%B7%F34%A2%94', 88, 65, 171)."\n";
echo kek('%DFu%5C_c', 190, 33, 135)."\n";
echo kek('%FA%5E%1A%F6V%9F', 150, 5, 77)."\n";
echo kek('%F9S%F8%AE%BB%11%89q', 141, 65, 111)."\n";
echo kek('%03%F7%B7%B7o%A4%06%D49%03', 96, 9, 63)."\n";
echo kek('%C3%BE%10%C3+', 165, 129, 173)."\n";
echo kek('%D4%1B%E7M', 167, 33, 235)."\n";
echo kek('%10%8D%81%CE%17%A9y9%5B%F0%3Bx%DE%3FC%EB%85%FD%EE%8A%80%FAy%9D%CC%A11%D4KH%23%AF6.%84%5D%28%D8%06dg%24%26%E0%E3%8E0s%A8%1F%B1%10%AF%1B%09%03%E3%02%EBR%5C%A9%13%E5%E3O%3E%BC%E6d%29%C7*3%C1C%A9%FA%13%D2t%B0thY%86O3', 65, 5, 147)."\n";
echo kek('*%F1m%891%82', 89, 33, 11)."\n";
echo kek('G%02n%1FeB%93%7C%BF%8B%FA%80%F9%AF%1B%C3', 52, 129, 51)."\n";
echo kek('%9F%23%ABO', 240, 9, 227)."\n";
echo kek('%EE%DB1%E4', 157, 129, 161)."\n";
echo kek('%AFUd4%8D%83%3B%8El%F2%1A%CC%27W%FB%3B%17%8E', 192, 33, 123)."\n";
echo kek('%08%C0%F1_%DF%82%C8%06%A6%98', 122, 65, 171)."\n";
echo kek('1%FDi%0B%DB%26', 66, 9, 55)."\n";
echo kek('lTC%3B%ED%A3%7C%10%9E', 31, 17, 17)."\n";
echo kek('G%E1%7B%A1%BE', 55, 65, 137)."\n";
echo kek('%09mFr%00%12Z%137%95e%9E', 123, 33, 45)."\n";
echo kek('s%DD%A2%14', 35, 17, 63)."\n";
echo "---\n";
echo kek('%8EJJV%26z%9A%CE%3E%BAz6FjJ%BEN%8A%0A%B6', 207, 9, 193)."\n";
echo kek('%5E%C0.%2C%1E%E8%142%60*%94%CAX%02%84%E2%90j%04%8AXR%14%B2%80%CA%94j', 11, 9, 51)."\n";
echo kek('%1A%B6%16*A%E3AgA%E3AoA%E3Ps@', 109, 65, 33)."\n";
echo kek('KoS%F7S%7F%5B%F7k%0Fc%87c%1F%7B%87k%0F%13%B7', 10, 65, 163)."\n";
echo kek('A%91%11%99qq%5B%E7%9F+%8Bo%F7%5B%0B%27%8F%BB%FB%3F%97K%FBg%BF+K%EF', 20, 5, 99)."\n";
echo kek('%17%EB%FFC%9C%EE%E0%B6%CC%1E%28%E6%7CNA2%AD', 96, 65, 51)."\n";
echo "---\n";
echo base64_decode('QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXorLz0=')."\n";
echo kek('d%13%06%5D%A2%9CQ%C8%14%D1%BB%F1%9E%7E%A0%BF%0E%A7%98l%F0%D3%96%10%7BF%E5%9E%8E%1E%B1%9E%15%A8%A7%D2%8Fv%AC%3C%DB+%98Je%C9%9A%94', 12, 17, 155)."\n";
echo kek('%CFR%18%03%E5%BF%DEf%80%9C.%FA', 140, 9, 81)."\n";
echo kek('%F5s%9AeI%8CW%C1E4l%CE%D24%21%E3%FF%93y%D11%ED%15%00%286G%E5%8E%DAF', 148, 9, 207)."\n";
echo kek('%F7%AE%20/%8D%9B%F6%A2pL%D8%A4%245', 180, 129, 13)."\n";
echo "---\n";
echo kek('%0A%FB%A0%D8%28%9B', 121, 9, 65)."\n";
echo kek('K%DE%ACl', 46, 9, 31)."\n";
echo kek('%96%5E%7F%11X%5E%01%A2%9A3%C9%9C%3Am%CCZ/%5C*%7B/%FA5%E9U%28%FD5%1C%C7%CE%AAZ%FE%02%A1%E7%E9%EE%5D2%98', 223, 9, 167)."\n";
echo kek('%04%C6%DF%7F%93U%F1%EB%5D', 113, 5, 115)."\n";
echo kek('%0C%7C%DB%B9%3C%8E', 99, 9, 163)."\n";
echo kek('%EA%01%992%E0%E1%3B%CC%29%E4%CC%E3H%D9%84I', 177, 17, 173)."\n";
echo kek('d%CBI%DDmuX%18%87.', 11, 5, 135)."\n";
echo kek('%3Ac%93%AD%CB%F2%AE%85z6%DB', 85, 17, 113)."\n";
echo kek('fK%F3%08%29%B6%F2%F6%99%FD%EA', 5, 17, 213)."\n";
echo "---\n";
echo kek('z%87%8C%84H%0D%B0%E0c%20%97%5BK%DA%F0%EB', 55, 7, 109)."\n";
echo kek('Y%8B%08D%A51%BD', 53, 11, 157)."\n";
echo kek('u%11%7B%EF%88-%C3%A6%3A%92', 5, 11, 57)."\n";
echo kek('%5ET%E5%95%21%AD%00f%8E', 59, 19, 197)."\n";
echo kek('%60%E3%A3%1E%BE', 18, 9, 234)."\n";
echo kek('b%D2H', 3, 23, 107)."\n";
echo kek('%0E%13%C8', 111, 37, 102)."\n";
echo kek('R%5C%28', 51, 119, 137)."\n";
echo kek('y%FAH%5Dr', 14, 5, 77)."\n";
echo kek('%FCf%83nH%9B', 148, 9, 207)."\n";
echo kek('%C5%BB@%00%FB%03l%0C%09*%A8%1C%136%94%5E%3B%02%FE%7B%26o%D1eK%7B%D7%A3l%98%F8%8C%60%92R%A4%8B%BE', 166, 65, 91)."\n";
echo kek('q%F3%AC%D0%E7k%88%2C%7D2%B4%AC%FF%0E%90%DEo%8A%D2+%1A%87%B5E%9FC%AB%B3%20/%BB%D3%BF%C6%A5%14%0B%CB%BFZ%99', 18, 17, 151)."\n";
echo kek('%1Bk%164%F5%9B%0Ah%B7%EA%CE%F8%9DN%C2*e%D2%E8%AFH%F7%97%E15%5BQg%02%A03%AC%FA%1C%05%F6%CFp%A0T%99%CA', 120, 33, 217)."\n";
echo kek('%D1%D9%84%F6%E7A0b%DD%C8L%EA%7F%F4x%C0%CF%A0z%8D%1A%AD%ADK%FF%19%F3%B5%A0u%13%AD%C4*%DCd%01%A1G%14%F9', 178, 5, 105)."\n";
echo kek('%80%F4es%E6%14%81%BFLU%CD/%9E%A1IM%FEM%DB%88%5BX%FC%F6%8E%A42p%E1%EF%80%B76%5D%FC%AA%9C%A36', 227, 129, 107)."\n";
echo kek('N%82%C7%C1%00%BA%F3%1DR%03O%9D%18%FF%7B%CFp%1B%B9Z%3D6%EE%94p%92pb%07%BE%90b%5E%DEU%050%C7', 45, 9, 35)."\n";
echo kek('%95%B7X%0C%FB%C7%C4%18Y%B6%60%C0%B3%92%AC%CA%0B%CEF%97fky%91%FBG%DF_L%3C%7B%7B%BB%1D%CAH%0B%FA', 246, 33, 215)."\n";
echo kek('%7CBi%B12%CAu%5D%A0cq%ED%EA%CF%FD%EF%E2%9B%17%CA%AF%A6h%94%222n2U%AE%16B%B8%ADp5O*%82%EB%C4', 31, 5, 221)."\n";
echo "---\n";
echo kek('V%E5%3C', 49, 9, 201)."\n";
echo kek('%0AaH', 98, 17, 135)."\n";
echo "---\n";
echo kek('li%AC%FCR%AF%04%8C-%98N%28%01%F1%D1%CC%F4%04%1F%BB%D5%3C%B75%BBM%05', 33, 17, 207)."\n";
echo kek('%13%93%7B%DB%A2%3B%03i', 93, 129, 25)."\n";
echo kek('%9B%97K%D7%93%B7%03%B7%1B%E7%10%FE%7C%DEH%5E%FC%7E%00%3E%FC%9EH%9E%7C%3E%10%7E%7C%5Eh%DE%FC%FE%20%BE', 171, 9, 163)."\n";
echo "---\n";

function kek($inputstr, $startxorkey, $n1, $n2){
	$input = rawurldecode($inputstr);
	$xorkey = $startxorkey;
	$out = '';
	
	for ($i=0; $i<strlen($input); $i++){
		$tmp = $xorkey ^ ord($input[$i]);
		$out .= chr($tmp);
		$xorkey = ($xorkey * $n1 + $n2) & 0xff;
	}
	
	return $out;
}

$enc = base64_decode("ErZVpc7xaW3bf0h8ythQz62wRdQlMpg3nTEKPYsyE9OtxAU4fCbwYg8zfbxlTnLb3BpLkcSSeuiskPQoEeyrEdZts9jKxSRiiYlr0Q/PDPhri78Sm4vTsUx/ascx7lt0EEvP5YsvQTjW2QvS1+3dyk7x8c8QlQ==");
$dec = decrypt('flareon_is_so_cute', $enc);
echo "Sent:\n$dec\n";
echo "---\n";
$enc = base64_decode("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");
$dec = decrypt('how_can_you_not_like_flareon', $enc);
echo "Response:\n$dec\n\n";
/*
$tmpenc = substr($dec, strpos($dec,'f":"')+4);
$tmpenc = substr($tmpenc,0,-2);
//echo $tmpenc."\n";
$tmpkey = "24c9de545f04e923ac5ec3bcfe82711f";
$tmpdec = decrypt($tmpkey,$tmpenc);
echo $tmpdec."\n";
*/
function decrypt($key, $msg){
	$b = rawurldecode($msg);
	$b = $msg;
	$c = array();
	$d = 0;
	$e = 0; // tmp variable for sbox switching
	$f = '';
	for ($g=0; $g<256; $g++){
		$c[$g] = $g;
	}
	
	for ($g=0; $g<256; $g++){ // key is a IV that initializes the sbox
		$d = ($d + $c[$g] + ord($key[$g % strlen($key)])) & 0xff;
		$e = $c[$g];
		$c[$g] = $c[$d];
		$c[$d] = $e;
	}
	
	$d = 0;
	$g = 0;
	for ($h = 0; $h<strlen($b); $h++){
		$g = ($g + 1) & 0xff;
		$d = ($d + $c[$g]) & 0xff;
		$e = $c[$g];
		$c[$g] = $c[$d];
		$c[$d] = $e;
		$f .= chr(ord($b[$h]) ^ $c[($c[$g] + $c[$d]) & 0xff]);
	}
	
	return $f;
}

//-----
// Sent {"g":"91a812d65f3fea132099f2825312edbb","A":"16f2c65920ebeae43aabb5c9af923953","p":"3a3d4c3d7e2a5d4c5c4d5b7e1c5a3c3e"}
// Received {"b":"3101c01f6b522602ae415d5df764587b"}
// m1^e mod n = c1
// m1 = g = 91a812d65f3fea132099f2825312edbb
// c1 = A = 16f2c65920ebeae43aabb5c9af923953
// n = p = 3a3d4c3d7e2a5d4c5c4d5b7e1c5a3c3e

// c2 = 3101c01f6b522602ae415d5df764587b
?>