from z3 import *
h = [115, 29, 32, 68, 106, 108, 89, 76, 21, 71, 78, 51, 75, 1, 55, 102]


h00 = BitVecVal(h[0] & 0xff, 8)
h01 = BitVecVal(h[1] & 0xff,8)
h02 = BitVecVal(h[2] & 0xff, 8)
h03 = BitVecVal(h[3] & 0xff, 8)
h04 = BitVecVal(h[4] & 0xff, 8)
h05 = BitVecVal(h[5] & 0xff, 8)
h06 = BitVecVal(h[6] & 0xff, 8)
h07 = BitVecVal(h[7] & 0xff, 8)
h08 = BitVecVal(h[8] & 0xff, 8)
h09 = BitVecVal(h[9] & 0xff, 8)
h10 = BitVecVal(h[10] & 0xff, 8)
h11 = BitVecVal(h[11] & 0xff, 8)
h12 = BitVecVal(h[12] & 0xff, 8)
h13 = BitVecVal(h[13] & 0xff, 8)
h14 = BitVecVal(h[14] & 0xff, 8)
h15 = BitVecVal(h[15] & 0xff, 8)

x00 = BitVec('x00', 8)
x01 = BitVec('x01', 8)
x02 = BitVec('x02', 8)
x03 = BitVec('x03', 8)
x04 = BitVec('x04', 8)
x05 = BitVec('x05', 8)
x06 = BitVec('x06', 8)
x07 = BitVec('x07', 8)
x08 = BitVec('x08', 8)
x09 = BitVec('x09', 8)
x10 = BitVec('x10', 8)
x11 = BitVec('x11', 8)
x12 = BitVec('x12', 8)
x13 = BitVec('x13', 8)
x14 = BitVec('x14', 8)
x15 = BitVec('x15', 8)


s = Solver()
#s.add(x00 >= 32, x00 <= 127)
#s.add(x01 >= 32, x01 <= 127)
#s.add(x02 >= 32, x02 <= 127)
#s.add(x03 >= 32, x03 <= 127)
#s.add(x04 >= 32, x04 <= 127)
#s.add(x05 >= 32, x05 <= 127)
#s.add(x06 >= 32, x06 <= 127)
#s.add(x07 >= 32, x07 <= 127)
#s.add(x08 >= 32, x08 <= 127)
#s.add(x09 >= 32, x09 <= 127)
#s.add(x10 >= 32, x10 <= 127)
#s.add(x11 >= 32, x11 <= 127)
#s.add(x12 >= 32, x12 <= 127)
#s.add(x13 >= 32, x13 <= 127)
#s.add(x14 >= 32, x14 <= 127)
#s.add(x15 >= 32, x15 <= 127)

s.add(h00 == x02 ^ x03 ^ x04 ^ x08 ^ x11 ^ x14)
s.add(h01 == x00 ^ x01 ^ x08 ^ x11 ^ x13 ^ x14)
s.add(h02 == x00 ^ x01 ^ x02 ^ x04 ^ x05 ^ x08 ^ x09 ^ x10 ^ x13 ^ x14 ^ x15)
s.add(h03 == x05 ^ x06 ^ x08 ^ x09 ^ x10 ^ x12 ^ x15)
s.add(h04 == x01 ^ x06 ^ x07 ^ x08 ^ x12 ^ x13 ^ x14 ^ x15)
s.add(h05 == x00 ^ x04 ^ x07 ^ x08 ^ x09 ^ x10 ^ x12 ^ x13 ^ x14 ^ x15)
s.add(h06 == x01 ^ x03 ^ x07 ^ x09 ^ x10 ^ x11 ^ x12 ^ x13 ^ x15)
s.add(h07 == x00 ^ x01 ^ x02 ^ x03 ^ x04 ^ x08 ^ x10 ^ x11 ^ x14)
s.add(h08 == x01 ^ x02 ^ x03 ^ x05 ^ x09 ^ x10 ^ x11 ^ x12)
s.add(h09 == x06 ^ x07 ^ x08 ^ x10 ^ x11 ^ x12 ^ x15)
s.add(h10 == x00 ^ x03 ^ x04 ^ x07 ^ x08 ^ x10 ^ x11 ^ x12 ^ x13 ^ x14 ^ x15)
s.add(h11 == x00 ^ x02 ^ x04 ^ x06 ^ x13)
s.add(h12 == x00 ^ x03 ^ x06 ^ x07 ^ x10 ^ x12 ^ x15)
s.add(h13 == x02 ^ x03 ^ x04 ^ x05 ^ x06 ^ x07 ^ x11 ^ x12 ^ x13 ^ x14)
s.add(h14 == x01 ^ x02 ^ x03 ^ x05 ^ x07 ^ x11 ^ x13 ^ x14 ^ x15)
s.add(h15 == x01 ^ x03 ^ x05 ^ x09 ^ x10 ^ x11 ^ x13 ^ x15)

print(s.check())

soln = s.model()
out = []
out.append(soln[x00])
out.append(soln[x01])
out.append(soln[x02])
out.append(soln[x03])
out.append(soln[x04])
out.append(soln[x05])
out.append(soln[x06])
out.append(soln[x07])
out.append(soln[x08])
out.append(soln[x09])
out.append(soln[x10])
out.append(soln[x11])
out.append(soln[x12])
out.append(soln[x13])
out.append(soln[x14])
out.append(soln[x15])
print(out)
